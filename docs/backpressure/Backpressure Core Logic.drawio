<mxfile host="Electron" modified="2025-07-06T21:08:58.637Z" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.8.2 Chrome/114.0.5735.289 Electron/25.8.1 Safari/537.36" etag="RGq0X3W8SNWxheI8iWBO" version="21.8.2" type="device">
  <diagram name="Page-1" id="tAE-cPwc15kO6dDDMqvA">
    <mxGraphModel dx="3213" dy="1156" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="0" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="R-dFO9PfzjRHCKzVX55h-19" value="Backpressure - general logic" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-183" y="274" width="242" height="42" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-20" value="current_suffix_size" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#DA9452;" vertex="1" parent="1">
          <mxGeometry x="134" y="383" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-80" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-22" target="R-dFO9PfzjRHCKzVX55h-78">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="877.9999999999995" y="703" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-22" value="input rate&lt;br&gt;(candidate incoming rate)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#DA9452;" vertex="1" parent="1">
          <mxGeometry x="1018" y="673" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-82" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-23" target="R-dFO9PfzjRHCKzVX55h-78">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="877.9999999999995" y="835" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-23" value="output rate&amp;nbsp;&lt;br&gt;(head moving)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#DA9452;" vertex="1" parent="1">
          <mxGeometry x="1018" y="827" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-26" value="&lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.max_suffix_size&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-144" y="385" width="142" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-34" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-27" target="R-dFO9PfzjRHCKzVX55h-71">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="431" y="628" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-27" value="Calculate how much of the suffix is filled&lt;br&gt;&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;fill_ratio&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="6" y="522" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-28" value="" style="shape=curlyBracket;whiteSpace=wrap;html=1;rounded=1;flipH=1;labelPosition=right;verticalLabelPosition=middle;align=left;verticalAlign=middle;rotation=90;" vertex="1" parent="1">
          <mxGeometry x="39.25" y="356.25" width="42.5" height="268" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-70" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-31" target="R-dFO9PfzjRHCKzVX55h-69">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-31" value="Compute how much the suffix has filled against&amp;nbsp;&lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.suffix_fill_threshold&lt;/span&gt;&lt;br&gt;&amp;nbsp;&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;fill_score&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;br&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-278" y="746" width="240" height="94" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-35" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-27" target="R-dFO9PfzjRHCKzVX55h-31">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="136" y="562" as="sourcePoint" />
            <mxPoint x="441" y="638" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-98" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-69" target="R-dFO9PfzjRHCKzVX55h-97">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-69" value="Convert from linear to weighted exponential&amp;nbsp;&lt;br&gt;&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;suffix_fill_weighted&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-227" y="920" width="138" height="65" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-73" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-71" target="R-dFO9PfzjRHCKzVX55h-86">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="431" y="954" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-77" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-71" target="R-dFO9PfzjRHCKzVX55h-78">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="743" y="797" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-71" value="Is &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;fill_ratio&lt;/span&gt; &amp;gt; &lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.suffix_rate_threshold&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="335" y="631" width="186" height="162" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-74" value="No" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="366" y="805" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-76" value="Yes" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="531" y="667" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-84" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-78">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="755" y="937" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-78" value="Compute the difference between input and output rate&lt;br&gt;&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;delta_rate&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="635" y="746" width="240" height="94" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-87" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="662.0046737213409" y="1017.9976190476186" as="sourcePoint" />
            <mxPoint x="428" y="1344" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-91" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-85" target="R-dFO9PfzjRHCKzVX55h-90">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-85" value="Is &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;delta_rate&lt;/span&gt; &amp;gt; &lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.rate_delta_threshold?&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="662" y="934" width="186" height="162" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-107" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-86" target="R-dFO9PfzjRHCKzVX55h-99">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="230" y="1369.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-86" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b style=&quot;&quot;&gt;rate_score&lt;/b&gt;&lt;/font&gt;" style="whiteSpace=wrap;html=1;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="369" y="1346.75" width="118" height="45.5" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-88" value="No" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="592" y="975.5" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-89" value="rate_score = 0&amp;nbsp;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="332" y="1214" width="87" height="23" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-94" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-90" target="R-dFO9PfzjRHCKzVX55h-86">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="755" y="1397" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-90" value="Convert &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;delta_rate&lt;/span&gt; to a &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;rate_score&lt;/span&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="695" y="1227" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-92" value="Yes" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="764" y="1109" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-105" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-97" target="R-dFO9PfzjRHCKzVX55h-99">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-158" y="1506.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-97" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;suffix_fill_weighted&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;rounded=0;fillColor=#6d8764;fontColor=#ffffff;strokeColor=#3A5431;" vertex="1" parent="1">
          <mxGeometry x="-248" y="1341" width="180" height="57" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-101" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-99" target="R-dFO9PfzjRHCKzVX55h-100">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-110" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-99" target="R-dFO9PfzjRHCKzVX55h-116">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-168" y="1610" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-280" y="1563" />
              <mxPoint x="-280" y="2554" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-99" value="Are either of the &lt;br&gt;scores above 0?" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="20" y="1482" width="186" height="162" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-103" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-100" target="R-dFO9PfzjRHCKzVX55h-102">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-100" value="Compute weight to be applied for the &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;rate_score&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;rate_weighted&lt;/span&gt; = 1 - fill_score_weighted" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-10" y="1773" width="246" height="72" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-113" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-102" target="R-dFO9PfzjRHCKzVX55h-112">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-102" value="&lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;rate_weighted&lt;/span&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="53" y="1931" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-108" value="Yes" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="122" y="1686" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-111" value="No" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-54" y="1525" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-115" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-112" target="R-dFO9PfzjRHCKzVX55h-114">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-112" value="Calculate the combined pressure score&lt;br&gt;&lt;br&gt;combined_score = suffix_fill_weighted + (rate_weighted * rate_score)&lt;br&gt;&lt;br&gt;" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-21" y="2071" width="267" height="93" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-119" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-114" target="R-dFO9PfzjRHCKzVX55h-118">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-114" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;combined_score&lt;/font&gt;&lt;/b&gt;" style="whiteSpace=wrap;html=1;fillColor=#003D1F;" vertex="1" parent="1">
          <mxGeometry x="42" y="2262" width="143" height="58.5" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-116" value="timeout in ms" style="whiteSpace=wrap;html=1;fillColor=#004C99;" vertex="1" parent="1">
          <mxGeometry x="52.5" y="2524" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-120" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="R-dFO9PfzjRHCKzVX55h-118" target="R-dFO9PfzjRHCKzVX55h-116">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-118" value="Calculate the timeout&lt;br&gt;timeout_ms = &lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.min_timeout_ms&lt;/span&gt; + &lt;br&gt;(&lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.max_timeout_ms&lt;/span&gt; - &lt;span style=&quot;background-color: rgb(234, 107, 102);&quot;&gt;config.min_time_ms&lt;/span&gt;) * &lt;span style=&quot;background-color: rgb(0, 102, 51);&quot;&gt;combined_score&lt;/span&gt;" style="whiteSpace=wrap;html=1;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="-76.5" y="2401" width="380" height="72.5" as="geometry" />
        </mxCell>
        <mxCell id="R-dFO9PfzjRHCKzVX55h-121" value="timeout_ms = 0" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="-272" y="2089" width="87" height="23" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
